(function() {
  function events() {
    const colors = document.querySelectorAll('.colors-box');
    const toggle = document.querySelector('button.toggle');
    const body = document.body;
    const delegate = (handler, timer = 300) => setTimeout(handler, timer);

    // Open/Close menu on button click
    toggle && toggle.addEventListener('click', (e) => {
      body.classList.toggle('menu-active');
      body.classList.add('is-animating');

      delegate(() => {
        body.classList.remove('is-animating');
      });
    });

    // Close menu on viewport size changes
    window.addEventListener('resize', (e) => {
      body.classList.remove('menu-active');
    });

    // Copy color to clipboard
    colors && colors.forEach((color) => {
      color.addEventListener('click', (e) => {
        const target = e.target && e.target.querySelector('.code') || {};
        const code = target.textContent || '';
        const input = document.createElement('textarea');

        input.value = code;
        document.body.appendChild(input);
        input.select();
        document.execCommand('copy');
        document.body.removeChild(input);

        target.textContent = 'copied!';
        target.style = `color: ${code}`;

        delegate(() => {
          target.textContent = code;
          target.style = '';
        });
      })
    });
  }

  document.addEventListener('DOMContentLoaded', events, false);
})();
