version: '3'

services:
  alice-nginx:
    container_name: alice-nginx
    image: alice-nginx:${BUILD_HASH}
    environment:
      - VIRTUAL_HOST=alice.local
      - NGINX_HOST=alice.local
      - FPM_HOST=alice-php7
    volumes:
      - "./config/nginx/conf.d/alice.conf:/etc/nginx/conf.d/xdebug.fastcgi_params"
      - "${PATH_PROJECTS}/alice:/var/www"
      - "${PATH_PROJECTS}/design-system:/var/www/node_modules/theiconic/design-system"
    networks:
      - theiconic

  alice-php7:
    container_name: alice-php7
    image: alice-fcgi:${BUILD_HASH}
    volumes:
      - "./config/php/fpm/conf.d/xdebug.ini:/usr/local/etc/php/conf.d/20-xdebug.ini"
      - "./config/eve/iconic.ini:/etc/iconic.ini"
      - "./config/alice/application.local.ini:/var/www/config/application.local.ini"
      - "${PATH_PROJECTS}/alice:/var/www"
      - "${PATH_PROJECTS}/design-system:/var/www/node_modules/theiconic/design-system"
    environment:
      - "APPLICATION_ENV=dev"
    networks:
      - theiconic
